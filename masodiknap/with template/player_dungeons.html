<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Damareen ‚Äì J√°t√©kos Kazamat√°k</title>
  {% load static %}
  <link rel="stylesheet" href="{% static 'style.css' %}">
  <script src="{% static 'script.js' %}" defer></script>
</head>
<body>
  <button class="btn back-btn" onclick="logout()">‚¨Ö Kijelentkez√©s</button>
  <div class="container">
    <h1>üó°Ô∏è V√°lassz Kazamat√°t</h1>
    <p class="info-message">Kattints egy kazamat√°ra √©s √°ll√≠tsd √∂ssze a paklidat a harchoz!</p>
    
    <div class="dungeons-grid" id="playerDungeonsGrid">
      {% for dungeon in dungeons %}
      <div class="dungeon-card">
        <h3>{{ dungeon.name }}</h3>
        <div class="dungeon-tags">
          <span class="tag">{{ dungeon.type }}</span>
          <span class="tag variant">{{ dungeon.variant }}</span>
        </div>
        <button class="btn" onclick="enterDungeon({{ dungeon.id }})">Bel√©p√©s</button>
      </div>
      {% empty %}
      <p class="info-message">Nincsenek el√©rhet≈ë kazamat√°k.</p>
      {% endfor %}
    </div>
  </div>

  <div id="playerDeckScreen" class="screen">
    <button class="btn return-btn" onclick="backToPlayerDungeons()">‚¨Ö Vissza</button>
    <div class="container">
      <h1>üìö Pakli √ñssze√°ll√≠t√°s</h1>
      <div class="deck-builder-container">
        <h2 id="playerDeckTitle">{{ selected_dungeon.name|default:"Kazamata neve" }}</h2>
        <div class="deck-info">
          <h3>Kiv√°lasztott k√°rty√°k: <span id="playerCardCount">0</span></h3>
          <p>Kattints a k√°rty√°kra a hozz√°ad√°shoz vagy elt√°vol√≠t√°shoz. V√°lassz strat√©gi√°t √©s k√©sz√ºlj fel a harcra!</p>
        </div>
        <div class="cards-grid" id="playerCardsGrid">
          {% for card in available_cards %}
          <div class="card-item" data-card-id="{{ card.id }}">
            <h4>{{ card.name }}</h4>
            <div class="card-stats">
              {% if card.type == 'spell' %}
                ‚ú® Var√°zslat
              {% else %}
                ‚öîÔ∏è {{ card.attack }} | üõ°Ô∏è {{ card.defense }}
              {% endif %}
            </div>
          </div>
          {% empty %}
          <p class="info-message">Nincsenek el√©rhet≈ë k√°rty√°k.</p>
          {% endfor %}
        </div>
        <form method="post" action="{% url 'start_battle' %}">
          {% csrf_token %}
          <input type="hidden" name="dungeon_id" id="dungeonIdInput" value="{{ selected_dungeon.id|default:'' }}">
          <input type="hidden" name="selected_cards" id="selectedCardsInput">
          <button type="submit" class="btn">‚öîÔ∏è Harc ind√≠t√°sa</button>
        </form>
      </div>
    </div>
  </div>
</body>
</html>